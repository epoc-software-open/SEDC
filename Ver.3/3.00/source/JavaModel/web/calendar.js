Calendar=function(a,b,c,e){this.timeout=this.getDateStatus=this.currentDateEl=this.activeDiv=null;this.onSelected=c||null;this.onClose=e||null;this.hidden=this.dragging=!1;this.minYear=1970;this.maxYear=2050;this.dateFormat=Calendar._TT.DEF_DATE_FORMAT;this.ttDateFormat=Calendar._TT.TT_DATE_FORMAT;this.weekNumbers=this.isPopup=!0;this.mondayFirst=a;this.dateStr=b;this.ar_days=null;this.showsTime=!1;this.time24=!0;this.activeYear=this.hilitedYear=this.activeMonth=this.hilitedMonth=this.yearsCombo=
this.monthsCombo=this.firstdayname=this.tbody=this.element=this.table=null;this.dateClicked=!1;if("undefined"==typeof Calendar._SDN){"undefined"==typeof Calendar._SDN_len&&(Calendar._SDN_len=3);a=[];for(b=8;0<b;)a[--b]=Calendar._DN[b].substr(0,Calendar._SDN_len);Calendar._SDN=a;"undefined"==typeof Calendar._SMN_len&&(Calendar._SMN_len=3);a=[];for(b=12;0<b;)a[--b]=Calendar._MN[b].substr(0,Calendar._SMN_len);Calendar._SMN=a}};Calendar._C=null;
Calendar.is_ie=/msie|trident/i.test(navigator.userAgent)&&!/opera/i.test(navigator.userAgent);Calendar.is_opera=/opera/i.test(navigator.userAgent);Calendar.is_khtml=/Konqueror|Safari|KHTML/i.test(navigator.userAgent);Calendar.getAbsolutePos=function(a){return gx.dom.position(a)};Calendar.isRelated=function(a,b){var c=b.relatedTarget;if(!c){var e=b.type;"mouseover"==e?c=b.fromElement:"mouseout"==e&&(c=b.toElement)}for(;c;){if(c==a)return!0;c=c.parentNode}return!1};
Calendar.removeClass=function(a,b){if(a&&a.className){for(var c=a.className.split(" "),e=[],d=c.length;0<d;)c[--d]!=b&&(e[e.length]=c[d]);a.className=e.join(" ")}};Calendar.addClass=function(a,b){Calendar.removeClass(a,b);a.className+=" "+b};Calendar.getElement=function(a){return Calendar.is_ie?window.event.srcElement:a.currentTarget};Calendar.getTargetElement=function(a){return Calendar.is_ie?window.event.srcElement:a.explicitOriginalTarget?a.explicitOriginalTarget:a.target};
Calendar.stopEvent=function(a){a||(a=window.event);Calendar.is_ie?(a.cancelBubble=!0,a.returnValue=!1):(a.preventDefault(),a.stopPropagation());return!1};Calendar.addEvent=function(a,b,c){a.attachEvent?a.attachEvent("on"+b,c):a.addEventListener?a.addEventListener(b,c,!0):a["on"+b]=c};Calendar.removeEvent=function(a,b,c){a.detachEvent?a.detachEvent("on"+b,c):a.removeEventListener?a.removeEventListener(b,c,!0):a["on"+b]=null};
Calendar.createElement=function(a,b){var c=null,c=document.createElementNS?document.createElementNS("http://www.w3.org/1999/xhtml",a):document.createElement(a);"undefined"!=typeof b&&b.appendChild(c);return c};Calendar._add_evs=function(a){with(Calendar)addEvent(a,"mouseover",dayMouseOver),addEvent(a,"mousedown",dayMouseDown),addEvent(a,"mouseout",dayMouseOut),is_ie&&(addEvent(a,"dblclick",dayMouseDblClick),a.setAttribute("unselectable",!0))};
Calendar.findMonth=function(a){return"undefined"!=typeof a.month?a:"undefined"!=typeof a.parentNode.month?a.parentNode:null};Calendar.findYear=function(a){return"undefined"!=typeof a.year?a:"undefined"!=typeof a.parentNode.year?a.parentNode:null};
Calendar.showMonthsCombo=function(){var a=Calendar._C;if(!a)return!1;var b=a.activeDiv,c=a.monthsCombo;a.hilitedMonth&&Calendar.removeClass(a.hilitedMonth,"hilite");a.activeMonth&&Calendar.removeClass(a.activeMonth,"active");var e=a.monthsCombo.getElementsByTagName("div")[a.date.getMonth()];Calendar.addClass(e,"active");a.activeMonth=e;a=c.style;a.display="block";a.left=0>b.navtype?b.offsetLeft+"px":b.offsetLeft+b.offsetWidth-c.offsetWidth+"px";a.top=b.offsetTop+b.offsetHeight+"px"};
Calendar.showYearsCombo=function(a){var b=Calendar._C;if(!b)return!1;var c=b.activeDiv,e=b.yearsCombo;b.hilitedYear&&Calendar.removeClass(b.hilitedYear,"hilite");b.activeYear&&Calendar.removeClass(b.activeYear,"active");b.activeYear=null;for(var d=b.date.getFullYear()+(a?1:-1),f=e.firstChild,g=!1,h=12;0<h;--h)d>=b.minYear&&d<=b.maxYear?(f.firstChild.data=d,f.year=d,f.style.display="block",g=!0):f.style.display="none",f=f.nextSibling,d+=a?2:-2;g&&(a=e.style,a.display="block",a.left=0>c.navtype?c.offsetLeft+
"px":c.offsetLeft+c.offsetWidth-e.offsetWidth+"px",a.top=c.offsetTop+c.offsetHeight+"px")};
Calendar.tableMouseUp=function(a){var b=Calendar._C;if(!b)return!1;b.timeout&&clearTimeout(b.timeout);var c=b.activeDiv;if(!c)return!1;var e=Calendar.getTargetElement(a);a||(a=window.event);Calendar.removeClass(c,"active");(e==c||e.parentNode==c)&&Calendar.cellClick(c,a);var d=Calendar.findMonth(e),c=null;if(d)c=new Date(b.date),d.month!=c.getMonth()&&(c.setMonth(d.month),b.setDate(c),b.dateClicked=!1,b.callHandler());else if(e=Calendar.findYear(e))c=new Date(b.date),e.year!=c.getFullYear()&&(c.setFullYear(e.year),
b.setDate(c),b.dateClicked=!1,b.callHandler());with(Calendar)return removeEvent(document,"mouseup",tableMouseUp),removeEvent(document,"mouseover",tableMouseOver),removeEvent(document,"mousemove",tableMouseOver),b._hideCombos(),_C=null,stopEvent(a)};
Calendar.tableMouseOver=function(a){var b=Calendar._C;if(b){var c=b.activeDiv,e=Calendar.getTargetElement(a);e==c||e.parentNode==c?(Calendar.addClass(c,"hilite active"),Calendar.addClass(c.parentNode,"rowhilite")):(("undefined"==typeof c.navtype||50!=c.navtype&&(0==c.navtype||2<Math.abs(c.navtype)))&&Calendar.removeClass(c,"active"),Calendar.removeClass(c,"hilite"),Calendar.removeClass(c.parentNode,"rowhilite"));a||(a=window.event);if(50==c.navtype&&e!=c){var d=Calendar.getAbsolutePos(c),f=c.offsetWidth,
g=a.clientX,h=!0;g>d.x+f?(g=g-d.x-f,h=!1):g=d.x-g;0>g&&(g=0);for(var d=c._range,f=c._current,g=Math.floor(g/10)%d.length,j=d.length;0<=--j&&d[j]!=f;);for(;0<g--;)h?--j in d||(j=d.length-1):++j in d||(j=0);c.firstChild.data=d[j];b.onUpdateTime()}(c=Calendar.findMonth(e))?c.month!=b.date.getMonth()?(b.hilitedMonth&&Calendar.removeClass(b.hilitedMonth,"hilite"),Calendar.addClass(c,"hilite"),b.hilitedMonth=c):b.hilitedMonth&&Calendar.removeClass(b.hilitedMonth,"hilite"):(b.hilitedMonth&&Calendar.removeClass(b.hilitedMonth,
"hilite"),(e=Calendar.findYear(e))?e.year!=b.date.getFullYear()?(b.hilitedYear&&Calendar.removeClass(b.hilitedYear,"hilite"),Calendar.addClass(e,"hilite"),b.hilitedYear=e):b.hilitedYear&&Calendar.removeClass(b.hilitedYear,"hilite"):b.hilitedYear&&Calendar.removeClass(b.hilitedYear,"hilite"));return Calendar.stopEvent(a)}};Calendar.tableMouseDown=function(a){if(Calendar.getTargetElement(a)==Calendar.getElement(a))return Calendar.stopEvent(a)};
Calendar.calDragIt=function(a){var b=Calendar._C;if(!b||!b.dragging)return!1;var c,e;Calendar.is_ie?(e=window.event.clientY+document.body.scrollTop,c=window.event.clientX+document.body.scrollLeft):(c=a.pageX,e=a.pageY);b.hideShowCovered();var d=b.element.style;d.left=c-b.xOffs+"px";d.top=e-b.yOffs+"px";return Calendar.stopEvent(a)};
Calendar.calDragEnd=function(a){var b=Calendar._C;if(!b)return!1;b.dragging=!1;with(Calendar)removeEvent(document,"mousemove",calDragIt),removeEvent(document,"mouseover",stopEvent),removeEvent(document,"mouseup",calDragEnd),tableMouseUp(a);b.hideShowCovered()};
Calendar.dayMouseDown=function(a){var b=Calendar.getElement(a);if(b.disabled)return!1;var c=b.calendar;try{if("function"==typeof c.params.inputField.onfocus)c.params.inputField.onfocus()}catch(e){gx.dbg.logEx(e,"calendar.js","Calendar.dayMouseDown")}c.activeDiv=b;Calendar._C=c;if(300!=b.navtype)with(Calendar)50==b.navtype&&(b._current=b.firstChild.data),addClass(b,"hilite active"),addEvent(document,"mouseover",tableMouseOver),addEvent(document,"mousemove",tableMouseOver),addEvent(document,"mouseup",
tableMouseUp);else c.isPopup&&c._dragStart(a);-1==b.navtype||1==b.navtype?(c.timeout&&clearTimeout(c.timeout),c.timeout=setTimeout("Calendar.showMonthsCombo()",250)):-2==b.navtype||2==b.navtype?(c.timeout&&clearTimeout(c.timeout),c.timeout=setTimeout(0<b.navtype?"Calendar.showYearsCombo(true)":"Calendar.showYearsCombo(false)",250)):c.timeout=null;return Calendar.stopEvent(a)};Calendar.dayMouseDblClick=function(a){Calendar.cellClick(Calendar.getElement(a),a||window.event);Calendar.is_ie&&document.selection.empty()};
Calendar.dayMouseOver=function(a){var b=Calendar.getElement(a);if(Calendar.isRelated(b,a)||Calendar._C||b.disabled)return!1;if(b.ttip){if("_"==b.ttip.substr(0,1)){var c=null;with(b.calendar.date)c=new Date(getFullYear(),getMonth(),b.caldate,12,0,0,0);b.ttip=c.print(b.calendar.ttDateFormat)+b.ttip.substr(1)}b.calendar.tooltips.firstChild.data=b.ttip}300!=b.navtype&&(Calendar.addClass(b,"hilite"),b.caldate&&Calendar.addClass(b.parentNode,"rowhilite"));return Calendar.stopEvent(a)};
Calendar.dayMouseOut=function(a){with(Calendar){var b=getElement(a);if(isRelated(b,a)||_C||b.disabled)return!1;removeClass(b,"hilite");b.caldate&&removeClass(b.parentNode,"rowhilite");b.calendar.tooltips.firstChild.data=_TT.SEL_DATE;return stopEvent(a)}};
Calendar.cellClick=function(a,b){var c=a.calendar,e=!1,d=!1,f=null,g=!1;if("undefined"==typeof a.navtype)Calendar.removeClass(c.currentDateEl,"selected"),Calendar.addClass(a,"selected"),e=c.currentDateEl==a,e||(c.currentDateEl=a),c.date.setDate(a.caldate),!c.showsTime&&c.date.getDate()!=a.caldate&&(c.date.setHours(12),c.date.setDate(a.caldate)),f=c.date,d=!0,c.dateClicked=!0;else{if(200==a.navtype){Calendar.removeClass(a,"hilite");c.callCloseHandler();return}f=0==a.navtype||1E3==a.navtype?new Date:
new Date(c.date);c.dateClicked=!1;var h=f.getFullYear(),j=f.getMonth(),l=function(a){var b=f.getDate(),c=f.getMonthDays(a);b>c&&f.setDate(c);f.setMonth(a)};switch(a.navtype){case 400:Calendar.removeClass(a,"hilite");e=Calendar._TT.ABOUT;e="undefined"!=typeof e?e+(c.showsTime?Calendar._TT.ABOUT_TIME:""):'Help and about box text is not translated into this language.\nIf you know this language and you feel generous please update\nthe corresponding file in "lang" subdir to match calendar-en.js\nand send it back to <mishoo@infoiasi.ro> to get it into the distribution  ;-)\n\nThank you!\nhttp://dynarch.com/mishoo/calendar.epl\n';
alert(e);return;case -2:h>c.minYear&&f.setFullYear(h-1);break;case -1:0<j?l(j-1):h-- >c.minYear&&(f.setFullYear(h),l(11));break;case 1:11>j?l(j+1):h<c.maxYear&&(f.setFullYear(h+1),l(0));break;case 2:h<c.maxYear&&f.setFullYear(h+1);break;case 100:c.setMondayFirst(!c.mondayFirst);return;case 50:e=a._range;d=a.firstChild.data;for(g=e.length;0<=--g&&e[g]!=d;);b&&b.shiftKey?--g in e||(g=e.length-1):++g in e||(g=0);a.firstChild.data=e[g];c.onUpdateTime();return;case 0:if("function"==typeof c.getDateStatus&&
c.getDateStatus(f,f.getFullYear(),f.getMonth(),f.getDate()))return!1;break;case 1E3:d=g=!0,c.dateClicked=!0}f.equalsTo(c.date)||(c.setDate(f,g),d=!0)}c.dateIsEmpty=g;d&&c.callHandler();e&&(Calendar.removeClass(a,"hilite"),c.callCloseHandler())};
Calendar.prototype.create=function(a){var b=null;a?(b=a,this.isPopup=null!=this.params.flat?!1:!0):(b=document.getElementsByTagName("body")[0],this.isPopup=!0);this.date=this.dateStr?new Date(this.dateStr):new Date;this.dateIsEmpty=!this.dateStr;this.table=a=Calendar.createElement("table");a.cellSpacing=0;a.cellPadding=0;a.calendar=this;Calendar.addEvent(a,"mousedown",Calendar.tableMouseDown);var c=Calendar.createElement("div");this.element=c;c.className="calendar Calendar";this.isPopup&&(c.style.position=
"absolute",c.style.zIndex="6",c.style.display="none");c.appendChild(a);var e=Calendar.createElement("thead",a),d=null,f=null,g=this,c=function(a,b,c){d=Calendar.createElement("td",f);d.colSpan=b;d.className="calendarbutton";if(c!=0&&Math.abs(c)<=2)d.className=d.className+" calendar-nav";Calendar._add_evs(d);d.calendar=g;d.navtype=c;a.substr(0,1)!="&"?d.appendChild(document.createTextNode(a)):d.innerHTML=a;return d},f=Calendar.createElement("tr",e),h=6;this.isPopup&&--h;this.weekNumbers&&++h;c("?",
1,400).ttip=Calendar._TT.INFO;this.title=c("",h,300);this.title.className="calendartitle";this.isPopup&&(this.title.ttip=Calendar._TT.DRAG_TO_MOVE,this.title.style.cursor="move",c("&#x00d7;",1,200).ttip=Calendar._TT.CLOSE);f=Calendar.createElement("tr",e);f.className="headrow";this._nav_py=c("&#x00ab;",1,-2);this._nav_py.ttip=Calendar._TT.PREV_YEAR;this._nav_pm=c("&#x2039;",1,-1);this._nav_pm.ttip=Calendar._TT.PREV_MONTH;this._nav_now=c(Calendar._TT.TODAY,this.weekNumbers?4:3,0);this._nav_now.ttip=
Calendar._TT.GO_TODAY;this._nav_nm=c("&#x203a;",1,1);this._nav_nm.ttip=Calendar._TT.NEXT_MONTH;this._nav_ny=c("&#x00bb;",1,2);this._nav_ny.ttip=Calendar._TT.NEXT_YEAR;f=Calendar.createElement("tr",e);f.className="daynames";this.weekNumbers&&(d=Calendar.createElement("td",f),d.className="name wn",d.appendChild(document.createTextNode(Calendar._TT.WK)));for(e=7;0<e;--e)d=Calendar.createElement("td",f),d.appendChild(document.createTextNode("")),e||(d.navtype=100,d.calendar=this,Calendar._add_evs(d));
this.firstdayname=this.weekNumbers?f.firstChild.nextSibling:f.firstChild;this._displayWeekdays();this.tbody=h=Calendar.createElement("tbody",a);for(e=6;0<e;--e){f=Calendar.createElement("tr",h);this.weekNumbers&&(d=Calendar.createElement("td",f),d.appendChild(document.createTextNode("")));for(var j=7;0<j;--j)d=Calendar.createElement("td",f),d.appendChild(document.createTextNode("")),d.calendar=this,Calendar._add_evs(d)}this.showsTime?(f=Calendar.createElement("tr",h),f.className="time",d=Calendar.createElement("td",
f),d.className="time",d.colSpan=2,d.innerHTML="&nbsp;",d=Calendar.createElement("td",f),d.className="time",d.colSpan=this.weekNumbers?4:3,function(){function a(b,c,e,f){var h=Calendar.createElement("span",d);h.className=b;h.appendChild(document.createTextNode(c));h.calendar=g;h.ttip=Calendar._TT.TIME_PART;h.navtype=50;h._range=[];if(typeof e!="number")h._range=e;else for(b=e;b<=f;++b)h._range[h._range.length]=b<10&&f>=10?"0"+b:""+b;Calendar._add_evs(h);return h}var b=g.date.getHours(),c=g.date.getMinutes(),
e=!g.time24,h=b>12;e&&h&&(b=b-12);var j=a("hour",b,e?1:0,e?12:23),b=Calendar.createElement("span",d);b.appendChild(document.createTextNode(":"));b.className="colon";var i=a("minute",c,0,59),p=null;d=Calendar.createElement("td",f);d.className="time";d.colSpan=2;e?p=a("ampm",h?"pm":"am",["am","pm"]):d.innerHTML="&nbsp;";g.onSetTime=function(){var a=this.date.getHours(),b=this.date.getMinutes(),c=a>12;c&&e&&(a=a-12);j.firstChild.data=a<10?"0"+a:a;i.firstChild.data=b<10?"0"+b:b;if(e)p.firstChild.data=
c?"pm":"am"};g.onUpdateTime=function(){var a=this.date,b=parseInt(j.firstChild.data,10);e&&(/pm/i.test(p.firstChild.data)&&b<12?b=b+12:/am/i.test(p.firstChild.data)&&b==12&&(b=0));var c=a.getDate(),d=a.getMonth(),f=a.getFullYear();a.setHours(b);a.setMinutes(parseInt(i.firstChild.data,10));a.setFullYear(f);a.setMonth(d);a.setDate(c);this.dateClicked=false;this.callHandler()}}()):this.onSetTime=this.onUpdateTime=function(){};a=Calendar.createElement("tfoot",a);this.isPopup||(f=Calendar.createElement("tr",
a),f.className="clearrow",d=c(Calendar._TT.CLEAR_DATE,this.weekNumbers?8:7,1E3),f.appendChild(d));f=Calendar.createElement("tr",a);f.className="footrow";d=c(Calendar._TT.SEL_DATE,this.weekNumbers?8:7,300);d.className="ttip";this.isPopup&&(d.ttip=Calendar._TT.DRAG_TO_MOVE,d.style.cursor="move");this.tooltips=d;this.monthsCombo=c=Calendar.createElement("div",this.element);c.className="calendarcombo";for(e=0;e<Calendar._MN.length;++e)a=Calendar.createElement("div"),a.className=Calendar.is_ie?"label-IEfix":
"label",a.month=e,a.appendChild(document.createTextNode(Calendar._SMN[e])),c.appendChild(a);this.yearsCombo=c=Calendar.createElement("div",this.element);c.className="calendarcombo";for(e=12;0<e;--e)a=Calendar.createElement("div"),a.className=Calendar.is_ie?"label-IEfix":"label",a.appendChild(document.createTextNode("")),c.appendChild(a);this._init(this.mondayFirst,this.date);b.appendChild(this.element)};
Calendar._keyEvent=function(a){if(!window.calendar)return!1;Calendar.is_ie&&(a=window.event);var b=window.calendar,c=Calendar.is_ie||"keypress"==a.type;if(a.ctrlKey)switch(a.keyCode){case 37:c&&Calendar.cellClick(b._nav_pm);break;case 38:c&&Calendar.cellClick(b._nav_py);break;case 39:c&&Calendar.cellClick(b._nav_nm);break;case 40:c&&Calendar.cellClick(b._nav_ny);break;default:return!1}else switch(a.keyCode){case 32:Calendar.cellClick(b._nav_now);break;case 27:c&&b.hide();break;case 37:case 38:case 39:case 40:if(c){var c=
b.date.getDate()-1,e=b.currentDateEl,d=null,f=37==a.keyCode||38==a.keyCode;switch(a.keyCode){case 37:0<=--c&&(d=b.ar_days[c]);break;case 38:c-=7;0<=c&&(d=b.ar_days[c]);break;case 39:++c<b.ar_days.length&&(d=b.ar_days[c]);break;case 40:c+=7,c<b.ar_days.length&&(d=b.ar_days[c])}d||(f?Calendar.cellClick(b._nav_pm):Calendar.cellClick(b._nav_nm),c=f?b.date.getMonthDays():1,e=b.currentDateEl,d=b.ar_days[c-1]);Calendar.removeClass(e,"selected");Calendar.addClass(d,"selected");b.date.setDate(d.caldate);b.callHandler();
b.currentDateEl=d}break;case 13:c&&(b.callHandler(),b.hide());break;default:return!1}return Calendar.stopEvent(a)};
Calendar.prototype._init=function(a,b,c){var e=new Date,d=b.getFullYear();d<this.minYear?(d=this.minYear,b.setFullYear(d)):d>this.maxYear&&(d=this.maxYear,b.setFullYear(d));this.mondayFirst=a;this.date=new Date(b);this.dateIsEmpty=!!c;var c=b.getMonth(),f=b.getDate(),g=b.getMonthDays();b.setDate(1);var h=b.getDay(),j=a?5:6,l=a?6:0;a&&(h=0<h?h-1:6);for(var a=1,k=this.tbody.firstChild,o=e.getFullYear()==d&&e.getMonth()==c,e=e.getDate(),m=b.getWeekNumber(),n=[],q=0;6>q;++q){if(a>g)k.className="emptyrow";
else{var i=k.firstChild;this.weekNumbers&&(i.className="day wn",i.firstChild.data=m,i=i.nextSibling);++m;k.className="daysrow";for(var p=0;7>p;++p){i.className="day";if(!q&&p<h||a>g){i.className="emptycell";try{i.innerHTML="&nbsp;"}catch(s){}i.disabled=!0}else{i.disabled=!1;i.firstChild.data=a;if("function"==typeof this.getDateStatus){b.setDate(a);var r=this.getDateStatus(b,d,c,a);!0===r?(i.className+=" disabled",i.disabled=!0):(/disabled/i.test(r)&&(i.disabled=!0),i.className+=" "+r)}if(!i.disabled&&
!this.dateIsEmpty&&(n[n.length]=i,i.caldate=a,i.ttip="_",a==f&&(i.className+=" selected",this.currentDateEl=i),o&&a==e&&(i.className+=" today",i.ttip+=Calendar._TT.PART_TODAY),h==j||h==l))i.className+=" weekend";++a;++h^7||(h=0)}i=i.nextSibling}}k=k.nextSibling}this.ar_days=n;this.title.firstChild.data=Calendar._MN[c]+", "+d;this.onSetTime()};Calendar.prototype.setDate=function(a,b){a.equalsTo(this.date)||this._init(this.mondayFirst,a,b)};
Calendar.prototype.refresh=function(){this._init(this.mondayFirst,this.date)};Calendar.prototype.setMondayFirst=function(a){this._init(a,this.date);this._displayWeekdays()};Calendar.prototype.setDateStatusHandler=Calendar.prototype.setDisabledHandler=function(a){this.getDateStatus=a};Calendar.prototype.setRange=function(a,b){this.minYear=a;this.maxYear=b};
Calendar.prototype.callHandler=function(){this.onSelected&&(this.onSelected(this,this.dateIsEmpty?"":this.date.print(this.dateFormat),this.params.inputField),gx.fn.setFocus(this.params.inputField))};Calendar.prototype.callCloseHandler=function(){if(this.onClose)this.onClose(this);this.hideShowCovered()};Calendar.prototype.destroy=function(){this.element.parentNode.removeChild(this.element);Calendar._C=null;window.calendar=null};
Calendar.prototype.reparent=function(a){var b=this.element;b.parentNode.removeChild(b);a.appendChild(b)};Calendar._checkCalendar=function(a){if(!window.calendar)return!1;if(!0==Calendar.is_ie){if(gx.evt.mouse.update(a),!gx.fx.isUnderMouse(calendar.element))return window.calendar.callCloseHandler(),Calendar.stopEvent(a)}else{for(var b=Calendar.getTargetElement(a);null!=b&&b!=calendar.element;b=b.parentNode);if(null==b)return window.calendar.callCloseHandler(),Calendar.stopEvent(a)}};
Calendar.prototype.show=function(){if(!0==this.params.inputField.disabled)return!1;for(var a=this.table.getElementsByTagName("tr"),b=a.length;0<b;){var c=a[--b];Calendar.removeClass(c,"rowhilite");for(var c=c.getElementsByTagName("td"),e=c.length;0<e;){var d=c[--e];Calendar.removeClass(d,"hilite");Calendar.removeClass(d,"active")}}this.element.style.display="block";this.hidden=!1;this.isPopup&&(window.calendar=this,Calendar.addEvent(document,"keydown",Calendar._keyEvent),Calendar.addEvent(document,
"keypress",Calendar._keyEvent),Calendar.addEvent(document,"mousedown",Calendar._checkCalendar));this.hideShowCovered()};Calendar.prototype.hide=function(){this.isPopup&&(Calendar.removeEvent(document,"keydown",Calendar._keyEvent),Calendar.removeEvent(document,"keypress",Calendar._keyEvent),Calendar.removeEvent(document,"mousedown",Calendar._checkCalendar));this.element.style.display="none";this.hidden=!0;this.hideShowCovered()};
Calendar.prototype.showAt=function(a,b){var c=this.element.style;this.params.displayRight?c.right=a+"px":c.left=a+"px";c.top=b+"px";this.show()};
Calendar.prototype.showAtElement=function(a,b){var c=gx.dom.position(a);if(!b||"string"!=typeof b)return this.showAt(c.x,c.y+gx.dom.dimensions(a).h),!0;var e=gx.dom.dimensions(this.element).w,d=gx.dom.dimensions(this.element).h,f=b.substr(0,1),g="l";1<b.length&&(g=b.substr(1,1));switch(f){case "T":c.y-=d;break;case "B":c.y+=a.offsetHeight;break;case "C":c.y+=(a.offsetHeight-d)/2;break;case "t":c.y+=a.offsetHeight-d}switch(g){case "L":c.x-=e;break;case "R":c.x+=a.offsetWidth;break;case "C":c.x+=(a.offsetWidth-
e)/2;break;case "r":c.x+=a.offsetWidth-e}e=gx.dom.position(this.element.parentNode);this.showAt(c.x-e.x,c.y-e.y)};Calendar.prototype.setDateFormat=function(a){this.dateFormat=a};Calendar.prototype.setTtDateFormat=function(a){this.ttDateFormat=a};Calendar.prototype.parseDate=function(a){a=gx.date.dateObject(a);gx.date.isNullDate(a)&&(a=new Date);this.setDate(a)};
Calendar.prototype.hideShowCovered=function(){var a=this;Calendar.continuation_for_the_fucking_khtml_browser=function(){function b(a){var b=a.style.visibility;b||(b=document.defaultView&&"function"==typeof document.defaultView.getComputedStyle?Calendar.is_khtml?"":document.defaultView.getComputedStyle(a,"").getPropertyValue("visibility"):a.currentStyle?a.currentStyle.visibility:"");return b}for(var c=["object","applet","iframe","select"],e=a.element,d=Calendar.getAbsolutePos(e),f=d.x,g=e.offsetWidth+
f,h=d.y,e=e.offsetHeight+h,j=c.length;0<j;)for(var l=document.getElementsByTagName(c[--j]),k=null,o=l.length;0<o;){var k=l[--o],d=Calendar.getAbsolutePos(k),m=d.x,n=k.offsetWidth+m,d=d.y,q=k.offsetHeight+d;a.hidden||m>g||n<f||d>e||q<h?(!k.__msh_save_visibility&&""!=k.__msh_save_visibility&&(k.__msh_save_visibility=b(k)),k.style.visibility="undefined"!=typeof k.__msh_save_visibility?k.__msh_save_visibility:""):(k.__msh_save_visibility||(k.__msh_save_visibility=b(k)),k.style.visibility="hidden")}};
Calendar.is_khtml?setTimeout("Calendar.continuation_for_the_fucking_khtml_browser()",10):Calendar.continuation_for_the_fucking_khtml_browser()};
Calendar.prototype._displayWeekdays=function(){for(var a=this.mondayFirst?0:1,b=this.mondayFirst?6:0,c=this.mondayFirst?5:6,e=this.firstdayname,d=0;7>d;++d)e.className="day name",d||(e.ttip=this.mondayFirst?Calendar._TT.SUN_FIRST:Calendar._TT.MON_FIRST,e.navtype=100,e.calendar=this,Calendar._add_evs(e)),(d==b||d==c)&&Calendar.addClass(e,"weekend"),e.firstChild.data=Calendar._SDN[d+1-a],e=e.nextSibling};
Calendar.prototype._hideCombos=function(){this.monthsCombo.style.display="none";this.yearsCombo.style.display="none"};
Calendar.prototype._dragStart=function(a){if(!this.dragging){this.dragging=!0;var b;Calendar.is_ie?(b=window.event.clientY+document.body.scrollTop,a=window.event.clientX+document.body.scrollLeft):(b=a.clientY+window.scrollY,a=a.clientX+window.scrollX);var c=this.element.style;this.xOffs=a-parseInt(c.left);this.yOffs=b-parseInt(c.top);with(Calendar)addEvent(document,"mousemove",calDragIt),addEvent(document,"mouseover",stopEvent),addEvent(document,"mouseup",calDragEnd)}};
Date._MD=[31,28,31,30,31,30,31,31,30,31,30,31];Date.SECOND=1E3;Date.MINUTE=60*Date.SECOND;Date.HOUR=60*Date.MINUTE;Date.DAY=24*Date.HOUR;Date.WEEK=7*Date.DAY;Date.prototype.getMonthDays=function(a){var b=this.getFullYear();"undefined"==typeof a&&(a=this.getMonth());return 0==b%4&&(0!=b%100||0==b%400)&&1==a?29:Date._MD[a]};Date.prototype.getDayOfYear=function(){var a=new Date(this.getFullYear(),this.getMonth(),this.getDate(),0,0,0),b=new Date(this.getFullYear(),0,1,0,0,0);return Math.floor((a-b)/Date.DAY)};
Date.prototype.getWeekNumber=function(){var a=new Date(this.getFullYear(),this.getMonth(),this.getDate(),0,0,0),b=new Date(this.getFullYear(),0,1,0,0,0),a=a-b,b=b.getDay();0==b&&(b=7);4<b&&(b-=4)||(b+=3);return Math.round((a/Date.DAY+b)/7)};Date.prototype.equalsTo=function(a){return this.getFullYear()==a.getFullYear()&&this.getMonth()==a.getMonth()&&this.getDate()==a.getDate()&&this.getHours()==a.getHours()&&this.getMinutes()==a.getMinutes()};
Date.prototype.print=function(a){var b=this.getMonth(),c=this.getDate(),e=this.getFullYear(),d=this.getWeekNumber(),f=this.getDay(),g={},h=this.getHours(),j=12<=h,l=j?h-12:h,k=this.getDayOfYear();0==l&&(l=12);var o=this.getMinutes(),m=this.getSeconds();g["%a"]=Calendar._SDN[f];g["%A"]=Calendar._DN[f];g["%b"]=Calendar._SMN[b];g["%B"]=Calendar._MN[b];g["%C"]=1+Math.floor(e/100);g["%d"]=10>c?"0"+c:c;g["%e"]=c;g["%H"]=10>h?"0"+h:h;g["%I"]=10>l?"0"+l:l;g["%j"]=100>k?10>k?"00"+k:"0"+k:k;g["%k"]=h;g["%l"]=
l;g["%m"]=9>b?"0"+(1+b):1+b;g["%M"]=10>o?"0"+o:o;g["%n"]="\n";g["%p"]=j?"PM":"AM";g["%P"]=j?"pm":"am";g["%s"]=Math.floor(this.getTime()/1E3);g["%S"]=10>m?"0"+m:m;g["%t"]="\t";g["%U"]=g["%W"]=g["%V"]=10>d?"0"+d:d;g["%u"]=f+1;g["%w"]=f;g["%y"]=(""+e).substr(2,2);g["%Y"]=e;g["%%"]="%";b=Date._msh_formatRegexp;if("undefined"==typeof b){var b="",n;for(n in g)b+=b?"|"+n:n;Date._msh_formatRegexp=b=RegExp("("+b+")","g")}return a.replace(b,function(a,b){return g[b]})};window.calendar=null;
